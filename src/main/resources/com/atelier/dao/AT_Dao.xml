<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.atelier.dao.AT_Dao">
	
	<insert id="ATProdInsert" parameterType="com.atelier.dto.PD_productDto">
	   INSERT INTO PD VALUES(PD_CODE_SEQ.NEXTVAL,#{pd_name},#{pd_price},#{pd_detail},#{pd_at_name},#{pd_option},
		   DEFAULT,SYSDATE,#{pd_cate},#{pd_type},#{pd_sex},#{pd_numofstock})
	</insert>
	
	<insert id="ATProdImgInsert" parameterType="com.atelier.dto.PI_productImgDto" >
	   INSERT INTO PI VALUES(PI_NUM_SEQ.NEXTVAL,#{pi_pd_code},#{pi_sysname},#{pi_oriname})
	</insert>
	
	<select id="getPd_code" resultType="Integer">
	   SELECT PD_CODE_SEQ.CURRVAL FROM DUAL
	</select>
	
	<insert id="setATRegistUserData" parameterType="com.atelier.dto.AG_Dto">
		INSERT INTO AG VALUES
		(#{ag_at_name},#{ag_phone},#{ag_id},#{ag_snsaddr},
		#{ag_cate1},#{ag_cate2},#{ag_cate3})
	</insert>
    
    <select id="getModifyProd" parameterType="Integer" resultType="com.atelier.dto.PD_productDto">
    	SELECT * FROM PD WHERE PD_CODE = #{pd_code}
    </select>
    
    <select id="getProdImg" parameterType="Integer" resultType="com.atelier.dto.PI_productImgDto">
    	SELECT * FROM PI WHERE PI_PD_CODE = #{pd_code}
    </select>
    
    <update id="ATProdUpdate" parameterType="com.atelier.dto.PD_productDto">
    	UPDATE PD SET PD_NAME = #{pd_name}, PD_PRICE = #{pd_price}, PD_DETAIL = #{pd_detail}, PD_AT_NAME = #{pd_at_name},
		PD_OPTION = #{pd_option},PD_CATE = #{pd_cate}, PD_TYPE = #{pd_type}, PD_SEX = #{pd_sex}, PD_NUMOFSTOCK = #{pd_numofstock} 
		WHERE PD_CODE = #{pd_code}
    </update>
    
    <update id="changeProdRegist" parameterType="String">
    	UPDATE PD SET PD_REGIST = 'TRUE' WHERE PD_CODE = #{pd_code}
    </update>
    
   <insert id="replyInsert" parameterType="com.atelier.dto.SM_Dto" useGeneratedKeys="true" 
      keyProperty="sm_num"> 
         <selectKey keyProperty="sm_num" resultType="int" order="BEFORE">
         SELECT SM_NUM_SEQ.NEXTVAL FROM DUAL
         </selectKey>         
         INSERT INTO SUPPORT_MG 
         VALUES(${sm_num}, #{sm_contents},SYSDATE, #{sm_sender},#{sm_receiver})
   </insert>
   
   <select id="getReplyList1" parameterType="String" resultType="com.atelier.dto.SM_Dto">
      SELECT * FROM SUPPORT_MG WHERE MG_RECEIVER = #{sm_receiver}
   </select>   
      
   <select id="getReplyList2" parameterType="com.atelier.dto.SM_Dto" resultType="com.atelier.dto.SM_Dto">
      SELECT * FROM SUPPORT_MG ORDER BY SM_NUM DESC
   </select>   
    
     <delete id="deleteImg" parameterType="Integer">
   	  DELETE FROM PI WHERE PI_PD_CODE = #{currentPd_code}
   </delete>
    
   <delete id="deleteProd" parameterType="Integer">
      DELETE FROM PD WHERE PD_CODE = #{pd_code}
   </delete>
   
   <delete id="chgDeliveryState" parameterType="Integer">
   	  UPDATE PO SET PO_STATE = 'being' WHERE PO_NUM = #{PO_NUM}
   </delete>
   
   <select id="getAM_Name" parameterType="String" resultType="String">
   	  SELECT AM_NAME FROM AM WHERE AM_ID = #{aT_id}	
   </select>
   
   <select id="getATOrderList" parameterType="com.atelier.vo.PO_Vo" resultType="com.atelier.vo.PO_Vo">
   	  SELECT * FROM POLIST WHERE PO_STATE = #{po_state} AND PO_AT_NAME = #{po_at_name}
   </select>
   
  
   
</mapper>