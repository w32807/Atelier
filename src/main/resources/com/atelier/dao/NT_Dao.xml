<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.atelier.dao.NT_Dao">
	<select id="getADNoticeList" parameterType="map" resultType="com.atelier.dto.CO_NoticeDto">
		<![CDATA[
		 SELECT * FROM 
        (SELECT ROWNUM RONUM, NT.* FROM 
          (SELECT * FROM NT ORDER BY NT_NUM )NT  )
        WHERE RONUM <=#{maxNum}-(#{pageNum}-1)*10
		AND RONUM>=#{maxNum}-(#{pageNum}-1)*10-9
		ORDER BY NT_NUM DESC
		]]>
	</select>
	
	<select id="getADNoticeCount" resultType="Integer">
		SELECT COUNT(*) FROM NTLIST
	</select>
	
	<select id="getADNoticeDetail" parameterType="Integer" resultType="com.atelier.dto.CO_NoticeDto">
		SELECT * FROM NT WHERE NT_NUM=#{nt_num}
	</select>
	
	<insert id="ADNoticeInsert" parameterType="com.atelier.dto.CO_NoticeDto">
   		INSERT INTO NT
   		VALUES(NT_NUM_SEQ.NEXTVAL,#{nt_title},#{nt_contents},#{nt_id},DEFAULT)
   </insert>
   
   <update id="ADNoticeUpdate" parameterType="com.atelier.dto.CO_NoticeDto">
   		UPDATE NT SET NT_TITLE=#{nt_title}, NT_CONTENTS=#{nt_contents}
   		WHERE NT_NUM=#{nt_num}
   </update>
   
   <delete id="ADNoticeDelete" parameterType="String">
   		DELETE NT WHERE NT_NUM=#{nt_num}
   </delete>
   
   <update id="viewCountUpdate" parameterType="Integer">
   		UPDATE NT SET NT_COUNT=NT_COUNT+1
   		WHERE NT_NUM=#{nt_num}
   </update>
   
   <!-- 공지사항 작성 -->
   <insert id="noticeWrite"  parameterType="com.atelier.dto.NT_Dto"  useGeneratedKeys="true" keyProperty="nt_num">
		<selectKey keyProperty="nt_num" resultType="int" order="BEFORE">
			SELECT NT_NUM_SEQ.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO NT VALUES (${nt_num},#{nt_title},#{nt_contents},#{nt_id},DEFAULT)
	</insert>
	
	<!--  공지사항 리스트 출력 -->
	<select id = "getList" resultType="com.atelier.dto.NT_Dto">
	<!-- id는 인터페이스에서 사용할 변수이름, resultType은 해당 데이터를 넣을 Dto를 써줌 
			resultType의 반환 형태는 String,int 등의 데이터 1개가 됨. 인터페이스에서 쓰는 형태는 list이지만,
			가져오는 데이터 값은 묶음이 아닌 하나하나의 데이터로 취급. 즉 가져오는 데이터가 1개이면 그 형태이고 가져올 때는 list로 mybatis가 보내준다-->
	<![CDATA[
			SELECT * FROM NT_LIST1
			WHERE RONUM>=#{pageNum}*10-9
			AND RONUM<=#{pageNum}*10
	]]><!-- xml 태그에 걸려, 특수문자가 처리가 안되는데, 특수문자를 써주고 싶을 때  <![CDATA[]]> 이 태그를 쓰면 그냥 문자열로 인식한다-->
		<!-- 여기서, 여러번 쓰이는 *가 의미가 다른데, mybatis에서 헷갈리지 않게 하기위해  <![CDATA[]]> 를 써준다. -->
		
	</select>
   <!-- 전체 공지사항 글 갯수 구하기 -->
   <select id="getBoardCount" resultType="Integer" >
			SELECT COUNT(*) FROM NT
	</select>
	<!--  공지사항 조회수 증가 -->
	<update id="upView" parameterType="Integer">
		UPDATE NT SET NT_COUNT=NT_COUNT+1
		WHERE NT_NUM=#{nt_num}
	</update>	
	
	
	<!--  공지사항 세부내용 출력 -->
	<select id="getContents"  parameterType="Integer" resultType="com.atelier.dto.NT_Dto" >
	
			SELECT * FROM NT_LIST1
				WHERE NT_NUM=#{nt_num}
	</select>
</mapper>